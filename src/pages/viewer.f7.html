<template>
    <div class="page" data-name="infected-quiz">
        <div class="navbar">
            <div class="navbar-bg"></div>
            <div class="navbar-inner sliding">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon icon-back"></i>
                        <span class="if-not-md">Back</span>
                    </a>
                </div>
                <div class="title-row">
                    <div class="col-100">
                        <div class="title--line-height">
                            Step
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="page-content">
            <div class="block block-title-medium">
                <p>Activity: {{ activity }}</p>
                <p>info: {{ info }}</p>
                <p>Step: {{ step }}</p>
                <p>options: {{ options }}</p>
            </div>
            <div class="list no-hairlines" id="quiz">
                <ul>
                    {{#each options}}
                    <li>
                        <label class="item-checkbox item-content">
                            <input type="checkbox" name="option" value="{{ value }}" />
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                                <div class="item-text quiz__text">
                                    ({{ value }}) {{ desc }}
                                </div>
                            </div>
                        </label>
                    </li>
                    {{/each}}
                </ul>

                <div class="block display-flex flex-direction-column justify-content-center align-content-space-around">
                    <a class="button button-fill button-large margin-top" @click="continue">Continuar</a>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
    export default {
        data: function() {
            var app = this.$app;
            var active = app.data.active;

            return {
                activity: active.activity,
                'step': active.step,
                'info': 'this is a info',
                'options': [{ value: 'a', desc: 'desc a' }]
            }
        },

        methods: {
            continue: function() {
                var app = this.$app;
                var active = app.data.active;
                var step = active.step;
                var activity = active.activity;
                
                let selections = document.querySelectorAll("#quiz input[type='checkbox']:checked");

                if(active.answers[step] == undefined) {
                    active.answers[step] = [];
                }

                if (selections.length) {
                    selections.forEach(item => {
                        active.answers[step].push(item.value);
                    });
                    active.step++;
                    this.$router.navigate("/viewer/" + activity + "/" + step);
                } else {
                    this.$app.dialog.alert("Selecione ao menos uma das opções anteriores.", "Coronavírus Chapecó");
                }
            },
        },

        on: {
            pageInit: function() {
                console.log('init');
            }
        }
    };
</script>

<style>
    .card__icon {
        height: 55px;
    }

    .quiz__text {
        color: #1e2f42;
        font-weight: bold;
    }

    .title--line-height {
        line-height: 1.3rem;
    }

    .card-footer--position-initial {
        position: initial;
    }
</style>
